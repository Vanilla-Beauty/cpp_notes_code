### **C++ `decltype` 类型推导规则速查表**  

| **表达式形式 (`e`)**       | **`decltype(e)` 推导结果**       | **示例**                          |
|---------------------------|----------------------------------|-----------------------------------|
| **变量名**（如 `x`）      | 该变量的**声明类型**（含 `const` 和引用） | `int x;` → `decltype(x)` 为 `int` |
| **类成员访问**（如 `obj.m`） | 成员的**声明类型**               | `obj.m` 是 `double` → `decltype(obj.m)` 为 `double` |
| **左值表达式**（如 `(x)`） | `T&`（引用）                    | `int x;` → `decltype((x))` 为 `int&` |
| **右值表达式**（如 `x + 1`） | `T`（非引用）                   | `decltype(1 + 2)` 为 `int`        |
| **函数调用**（如 `f()`）   | 返回值的**实际类型**（保留引用） | `int& f();` → `decltype(f())` 为 `int&` |

### **对比 `auto`**
| **关键字**  | **是否忽略顶层 `const` 和引用** | **示例**                          |
|------------|-------------------------------|-----------------------------------|
| `auto`     | 是（推导为值类型）             | `const int x = 10; auto y = x;` → `y` 是 `int` |
| `decltype` | 否（完全保留原类型）           | `const int x = 10; decltype(x) y;` → `y` 是 `const int` |

适用于 **模板元编程、返回值类型推导、复杂表达式类型捕获** 等场景。